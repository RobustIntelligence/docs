<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Custom Tests &mdash; RIME  documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
        <script src="../../../../_static/clipboard.min.js"></script>
        <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="NLP Tests" href="../nlp.html" />
    <link rel="prev" title="Tests" href="tests.html" />
<link href="../../../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">
<div class="ge_header no-print">
    <a id="header-logo" href="../../../../index.html">
        <img src="../../../../_static/header-logo.png" alt="logo" />
    </a>
</div>


  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            RIME
          </a>
              <div class="version">
                0.16.14
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">RIME</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../product-overview.html">Product Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../product-details.html">Product Details</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html">RIME v16 Changelog</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../test_descriptions.html">Tests</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../tabular.html">Tabular Tests</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="tests.html">Tests</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Custom Tests</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../nlp.html">NLP Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cv.html">CV Tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../ui.html">UI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user-management.html">User Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notifications.html">Alerts and Notifications</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../get_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../get_started/quickstart.html">Running Your First AI Stress Test</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Walkthroughs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../walkthroughs/python-sdk.html">Python SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../walkthroughs/python-library.html">Python Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../walkthroughs/cli.html">CLI</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Configuring RIME</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../configuration/tabular.html">Tabular Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../configuration/nlp.html">NLP Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../configuration/cv.html">CV Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference/api-authentication.html">API Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference/python-sdk.html">Python SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference/python-library.html">Python Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference/cli.html">CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference/integrations.html">Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference/troubleshooting.html">Troubleshooting</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">RIME</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../product-details.html">Product Details</a></li>
          <li class="breadcrumb-item"><a href="../../test_descriptions.html">Tests</a></li>
          <li class="breadcrumb-item"><a href="../tabular.html">Tabular Tests</a></li>
      <li class="breadcrumb-item active">Custom Tests</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/rime/product-details/tests/tabular/custom_tests.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="custom-tests">
<h1>Custom Tests<a class="headerlink" href="#custom-tests" title="Permalink to this heading">ÔÉÅ</a></h1>
<p>With RIME, it is easy to specify custom tests.
The below steps walk through how to do so. If you run into any difficulties, please contact your Robust Intelligence support engineer and they will assist you.</p>
<p>First, you must define a custom test in a Python file.
This Python file should expose a class named CustomBatchRunner, which should inherit from the DataTestBatchRunner interface that RIME defines.
After inheriting from this class you will need to implement 6 methods:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_from_config</span></code>: this is a class method that takes in a TabularRunContainer and a config and returns the CustomBatchRunner initialized with a list of TestCases (see below for information on what a test is).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_outputs_to_batch_res</span></code>: this method is responsible for aggregating the results from the individual TestCases run into a TestBatch result.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code>: a property with a description of the test, only used in the UI.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">long_description</span></code>: a property with a long description of the test, only used in the UI.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code>: a property with the type of the test, only used in the UI.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">category</span></code>: a property with the name of the category of the test, only used in the UI.</p></li>
</ol>
<p>As mentioned above, this CustomBatchRunner will contain multiple TestCases.
These are a collection of test cases that will be aggregated inside the overall batch runner.
As an example of this, if you write a specific test that you want to apply to each column in the dataset, it would make sense to have the BatchRunner be initialized with a list of tests, one for each feature.</p>
<p>The test cases that you define should inherit from the BaseTest class that RIME defines.
After inheriting from this class you will need to implement one method:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">run</span></code>: this method takes in a TabularRunContainer and returns a TestOuput (the result of the test) and a dictionary of extra info (that can be used when aggregating test results in the BatchRunner)</p></li>
</ol>
<p>After defining this Python file, you can reference it in the test configuration file, eg</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;custom_tests&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;test_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;custom_test.py&quot;</span><span class="p">}]</span>
</pre></div>
</div>
<p>An example of a custom test file is below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Custom test batch runner.&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="kn">from</span> <span class="nn">rime.core.schema</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CustomConfig</span><span class="p">,</span>
    <span class="n">ImportanceLevel</span><span class="p">,</span>
    <span class="n">Status</span><span class="p">,</span>
    <span class="n">TableColumn</span><span class="p">,</span>
    <span class="n">TestBatchResult</span><span class="p">,</span>
    <span class="n">TestCategory</span><span class="p">,</span>
    <span class="n">TestOutput</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">rime.core.test</span> <span class="kn">import</span> <span class="n">BaseTest</span>
<span class="kn">from</span> <span class="nn">rime.tabular.data_tests.batch_runner</span> <span class="kn">import</span> <span class="n">DataTestBatchRunner</span>
<span class="kn">from</span> <span class="nn">rime.tabular.data_tests.schema.result</span> <span class="kn">import</span> <span class="n">DataTestBatchResult</span><span class="p">,</span> <span class="n">DataTestOutput</span>
<span class="kn">from</span> <span class="nn">rime.tabular.profiler.run_containers</span> <span class="kn">import</span> <span class="n">TabularRunContainer</span>


<span class="k">class</span> <span class="nc">CustomTest</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delta</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize with a delta between n_rows ref and eval.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="n">delta</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_container</span><span class="p">:</span> <span class="n">TabularRunContainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">TestOutput</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">run_container</span><span class="o">.</span><span class="n">ref_data</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
            <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">run_container</span><span class="o">.</span><span class="n">test_data</span><span class="o">.</span><span class="n">df</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span>
        <span class="p">):</span>
            <span class="n">status</span> <span class="o">=</span> <span class="n">Status</span><span class="o">.</span><span class="n">WARNING</span>
            <span class="n">severity</span> <span class="o">=</span> <span class="n">ImportanceLevel</span><span class="o">.</span><span class="n">HIGH</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="n">Status</span><span class="o">.</span><span class="n">PASS</span>
            <span class="n">severity</span> <span class="o">=</span> <span class="n">ImportanceLevel</span><span class="o">.</span><span class="n">NONE</span>
        <span class="n">test_output</span> <span class="o">=</span> <span class="n">DataTestOutput</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;Severity&quot;</span><span class="p">:</span> <span class="n">severity</span><span class="p">},</span> <span class="n">severity</span><span class="p">,</span> <span class="p">[],</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">test_output</span><span class="p">,</span> <span class="p">{}</span>


<span class="k">class</span> <span class="nc">CustomBatchRunner</span><span class="p">(</span><span class="n">DataTestBatchRunner</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;TestBatchRunner for the CustomTest.&quot;&quot;&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_from_config</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">run_container</span><span class="p">:</span> <span class="n">TabularRunContainer</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">CustomConfig</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataTestBatchRunner&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;delta&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">([</span><span class="n">CustomTest</span><span class="p">(</span><span class="n">delta</span><span class="o">=</span><span class="n">delta</span><span class="p">)])</span>

    <span class="k">def</span> <span class="nf">_outputs_to_batch_res</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">run_container</span><span class="p">:</span> <span class="n">TabularRunContainer</span><span class="p">,</span>
        <span class="n">outputs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">DataTestOutput</span><span class="p">],</span>
        <span class="n">extra_infos</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
        <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">return_extra_infos</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TestBatchResult</span><span class="p">:</span>
        <span class="n">long_description_tabs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Description&quot;</span><span class="p">,</span> <span class="s2">&quot;contents&quot;</span><span class="p">:</span> <span class="s2">&quot;This is a custom test&quot;</span><span class="p">},</span>
            <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Why it Matters&quot;</span><span class="p">,</span> <span class="s2">&quot;contents&quot;</span><span class="p">:</span> <span class="s2">&quot;This matters for customizability&quot;</span><span class="p">},</span>
            <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Configuration&quot;</span><span class="p">,</span> <span class="s2">&quot;contents&quot;</span><span class="p">:</span> <span class="s2">&quot;This has a simple configuration&quot;</span><span class="p">},</span>
            <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Example&quot;</span><span class="p">,</span> <span class="s2">&quot;contents&quot;</span><span class="p">:</span> <span class="s2">&quot;This by itself is an example&quot;</span><span class="p">},</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="n">DataTestBatchResult</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
            <span class="n">long_description_tabs</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">category</span><span class="p">,</span>
            <span class="n">outputs</span><span class="p">,</span>
            <span class="p">[],</span>
            <span class="n">duration</span><span class="p">,</span>
            <span class="n">extra_infos</span><span class="p">,</span>
            <span class="p">[</span><span class="n">TableColumn</span><span class="p">(</span><span class="s2">&quot;Severity&quot;</span><span class="p">)],</span>
            <span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">severity</span><span class="p">,</span>
            <span class="n">show_in_test_comparisons</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;This is custom test&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">long_description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;This is a long description of a custom test.&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;customer custom test&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">category</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TestCategory</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;no real category&quot;</span>

</pre></div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tests.html" class="btn btn-neutral float-left" title="Tests" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../nlp.html" class="btn btn-neutral float-right" title="NLP Tests" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Robust Intelligence.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>